<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
              <section data-markdown>
                <script type="text/template">
                  # Practical TDD in JS
                  ## Justin McCandless
                  #### [justinmc.github.io/tdd-talk](https://justinmc.github.io/tdd-talk)
                </script>
                <aside class="notes">
                  - Let Rithm School introduce themselves?
                </aside>
              </section>
              <section data-markdown>
                <script type="text/template">
                  ## Hi I'm Justin
                  <ul class="fragment">
                    <li>Engineer at Autodesk Life Sciences</li>
                    <ul>
                      <li>(we're hiring QA/Frontend/Cloud)</li>
                    </ul>
                    <li>Keep in touch</li>
                    <ul>
                      <li>@justinjmcc</li>
                      <li>justinjmccandless@gmail.com</li>
                      <li>justinmccandless.com</li>
                    </ul>
                  </ul>
                </script>
                <aside class="notes">
                  - Gauge TDD/coding experience in audience
                </aside>
              </section>
              <section data-markdown>
                <script type="text/template">
                  ## Hi I'm Justin
                  <ul>
                    <li>Introduced to TDD at a Software Craftmanship meetup in 2013</li>
                    <li>Now find myself doing TDD even in solo side projects...</li>
                  </ul>
                </script>
                <aside class="notes">
                  - Thought TDD was radical at first.
                  - At times company wants me to do TDD.
                  - More into unit testing, started using it as a PRACTICAL tool.
                </aside>
              </section>
              <section data-markdown>
                <script type="text/template">
                  ## What to Expect
                  <ul>
                    <li class="fragment">First a little bit of theory.</li>
                    <li class="fragment">We'll work through an example together.</li>
                    <li class="fragment">Then I'll turn it over to you guys to implement and test a feature on your own.</li>
                  </ul>
                  <aside class="notes">
                    - In the example, I write the code, audience writes tests.
                    - Mocha and Karma
                  </aside>
                </script>
              </section>
              <section>
                <section data-markdown>
                  <script type="text/template">
                    ## Test Driven Development
                    <ol class="fragment">
                      <li>Define the feature.</li>
                      <li>Write tests to cover it.</li>
                      <li>Code the feature.</li>
                      <li>You're done when the tests pass.</li>
                    </ol>
                  </script>
                  <aside class="notes">
                    - Compare this to regular development, oh shit I haven't written any tests...
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ## Testing Vocabulary Test
                    <ul>
                      <li>Unit test?</li>
                      <ul class="fragment">
                        <li>Test a small unit of code directly, i.e. test an isolated method.</li>
                      </ul>
                      <li>End-to-end test?</li>
                      <ul class="fragment">
                        <li>Test an overall feature as the user would experience it, like via browser automation.</li>
                      </ul>
                  </script>
                  <aside class="notes">
                    - Functional test, acceptance test, etc.
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ## Test Driven Development
                    - In the strict definition, this would refer to unit tests.
                    - Behavior Driven Development (BDD) focuses on defining and testing "behaviors".
                  </script>
                  <aside class="notes">
                    - Cucumber is a good example of BDD.
                    - Don't be strict on the test type, write what is most useful to you.
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ## Why TDD?
                    <ul class="fragment">
                      <li>Ensures that tests get written.</li>
                      <li>Often results in more robust code with fewer regressions.</li>
                      <li>Great to keep two devs on the same page during pairing.</li>
                      <li>Promotes writing atomic, testable code.</li>
                    </ul>
                  </script>
                  <aside class="notes">
                    - But why jump through all these hoops?
                    - Promotes good habits and encourages good code!
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ## Why not TDD?
                    <ul class="fragment">
                      <li>It takes longer!</li>
                      <li>Focuses on a mechanic instead of on writing good code.</li>
                      <li>What if you won't know what tests to write before you write the code?</li>
                      <li>By the way, Microsoft posted a blog post titled [#NoTDD](https://blogs.msdn.microsoft.com/ericgu/2017/06/22/notdd/) shortly after I chose this topic for this talk...</li>
                    </ul>
                  </script>
                  <aside class="notes">
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ## JS Tools for TDD
                    - Need:
                    <ul class="fragment">
                      <li>Assertion library like [Chai](http://chaijs.com/)</li>
                      <li>Test framework like [Mocha](https://mochajs.org/)</li>
                      <li>Test runner like [Karma](https://karma-runner.github.io/1.0/index.html)</li>
                    </ul>
                    - Want:
                    <ul class="fragment">
                      <li>Mocking library like [Sinon](http://sinonjs.org/)</li>
                      <li>E2E framework like [Nightwatch](http://nightwatchjs.org)</li>
                    </ul>
                  </script>
                  <aside class="notes">
                    - Lots of alternatives and other useful stuff too.  Most are very similar to these.
                  </aside>
                </section>
              </section>
              <section>
                <section data-markdown>
                  <script type="text/template">
                    ## Example: SVG Dragging
                    <img alt="Dragging Animation" src="./img/dragging.gif" />
                  </script>
                  <aside class="notes">
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ### Two Coordinate Systems
                    <img alt="Dragging Coordinates" src="./img/screenshot_dragging.png" />
                  </script>
                  <aside class="notes">
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ### Two Coordinate Systems
                    <img alt="Dragging Coordinates" src="./img/screenshot_dragging_points.png" />
                  </script>
                  <aside class="notes">
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ### Convert Between Them
                    ```
                    /**
                     * Convert between DOM coords and SVG viewbox coords
                     * @param {Number} width
                     * @param {Number} height
                     * @param {Number} x
                     * @param {Number} y
                     * @returns {{ x: Number, y: Number }}
                     */
                    function toViewBoxCoords(width, height, x, y) {
                      // TODO
                      return {
                        x: 0,
                        y: 0,
                      };
                    }
                    ```
                  </script>
                  <aside class="notes">
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ### Tests First!
                    ```
                    const expect = require('chai').expect;
                    const { toViewBoxCoords } = require('../src/svg');

                    describe('svg', () => {
                      describe('toViewBoxCoords', () => {
                        // TODO
                      });
                    });
                    ```
                  </script>
                  <aside class="notes">
                    - Switch to live code at this point
                    - Write test cases in spec first.
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ### Possible Tests
                    ```
                    const expect = require('chai').expect;
                    const { toViewBoxCoords } = require('../src/svg');

                    describe('svg', () => {
                      describe('toViewBoxCoords', () => {
                        const width = 1200;
                        const height = 800;
                        let x;
                        let y;

                        it('is a function', () => {
                          expect(toViewBoxCoords).to.be.a('function');
                        });

                        describe('when browser point is at the origin', () => {
                          beforeEach(() => {
                            x = 0;
                            y = 0;
                          });

                          it('gives an svg point at the origin', () => {
                            const svgCoords = toViewBoxCoords(width, height, x, y);
                            expect(svgCoords.x).to.equal(0);
                            expect(svgCoords.y).to.equal(0);
                          });
                        });

                        describe('when browser point is opposite the origin', () => {
                          beforeEach(() => {
                            x = width;
                            y = height;
                          });

                          it('gives an svg point at the origin', () => {
                            const svgCoords = toViewBoxCoords(width, height, x, y);
                            expect(svgCoords.x).to.equal(svgConstants.DIMENSIONS_X);
                            expect(svgCoords.y).to.equal(svgConstants.DIMENSIONS_Y);
                          });
                        });

                        describe('when browser point is in the center', () => {
                          beforeEach(() => {
                            x = width / 2;
                            y = height / 2;
                          });

                          it('gives an svg point at the center of the svg', () => {
                            const svgCoords = toViewBoxCoords(width, height, x, y);
                            expect(svgCoords.x).to.equal(svgConstants.DIMENSIONS_X / 2);
                            expect(svgCoords.y).to.equal(svgConstants.DIMENSIONS_Y / 2);
                          });
                        });
                      });
                    });
                    ```
                  </script>
                  <aside class="notes">
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ## Possible Method
                    ```
                    /**
                     * Convert between DOM coords and SVG viewbox coords
                     * @param {Number} width
                     * @param {Number} height
                     * @param {Number} x
                     * @param {Number} y
                     * @returns {{ x: Number, y: Number }}
                     */
                    function toViewBoxCoords(width, height, x, y) {
                      return {
                        x: svgConstants.DIMENSIONS_X * x / width,
                        y: svgConstants.DIMENSIONS_Y * y / height,
                      };
                    }
                    ```
                  </script>
                  <aside class="notes">
                  </aside>
                </section>
              </section>
              <section>
                <section data-markdown>
                  <script type="text/template">
                    ## Your Turn
                    <img alt="Collision Animation" src="./img/collision.gif" />
                  </script>
                  <aside class="notes">
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ## Detect Collisions
                    ```
                    /**
                     * Given two rectangles, returns true if they're overlapping, false otherwise
                     * @param {{ x: Number, y: Number, width: Number, height: Number }} boxA
                     * @param {{ x: Number, y: Number, width: Number, height: Number }} boxB
                     * @returns {Boolean}
                     */
                    function isColliding(rectA, rectB) {
                      // TODO
                      return false;
                    }
                    ```
                  </script>
                  <aside class="notes">
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ## Need Specs
                    ```
                    const expect = require('chai').expect;
                    const { isColliding, toViewBoxCoords } = require('../src/svg');

                    describe('svg', () => {
                      describe('toViewBoxCoords', () => {
                        ...
                      });

                      describe('isColliding', () => {
                        // TODO
                      });
                    });
                    ```
                  </script>
                  <aside class="notes">
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ## Possible Tests
                    ```
                    const expect = require('chai').expect;
                    const { isColliding, toViewBoxCoords } = require('../src/svg');

                    describe('svg', () => {
                      describe('toViewBoxCoords', () => {
                        ...
                      });

                      describe('isColliding', () => {
                        let boxA;
                        let boxB;

                        beforeEach(() => {
                          boxA = {};
                          boxB = {};
                        });

                        describe('when they\'re directly on top of each other', () => {
                          beforeEach(() => {
                            boxA = {
                              x: 0,
                              y: 0,
                              width: 10,
                              height: 10,
                            };
                            boxB = Object.assign({}, boxA);
                          });

                          it('returns true', () => {
                            expect(isColliding(boxA, boxB)).to.be.true;
                          });
                        });

                        describe('when one is fully to the side of the other', () => {
                          beforeEach(() => {
                            boxA = {
                              x: 0,
                              y: 0,
                              width: 10,
                              height: 10,
                            };
                            boxB = {
                              x: 11,
                              y: 0,
                              width: 10,
                              height: 10,
                            };
                          });

                          it('returns false', () => {
                            expect(isColliding(boxA, boxB)).to.be.false;
                          });
                        });

                        describe('when they overlap in the x direction', () => {
                          beforeEach(() => {
                            boxA.x = 0;
                            boxA.width = 10;
                            boxB.x = 5;
                            boxB.width = 10;
                          });

                          describe('when they also overlap in the y direction', () => {
                            beforeEach(() => {
                              boxA.y = 0;
                              boxA.height = 10;
                              boxB.y = 5;
                              boxB.height = 10;
                            });

                            it('returns true', () => {
                              expect(isColliding(boxA, boxB)).to.be.true;
                            });
                          });

                          describe('when they do not overlap in the y direction', () => {
                            beforeEach(() => {
                              boxA.y = 0;
                              boxA.height = 10;
                              boxB.y = 20;
                              boxB.height = 10;
                            });

                            it('returns false', () => {
                              expect(isColliding(boxA, boxB)).to.be.false;
                            });
                          });
                        });

                        describe('when they do not overlap in the x direction', () => {
                          beforeEach(() => {
                            boxA.x = 0;
                            boxA.width = 10;
                            boxB.x = 20;
                            boxB.width = 10;
                          });

                          describe('when they overlap in the y direction', () => {
                            beforeEach(() => {
                              boxA.y = 0;
                              boxA.height = 10;
                              boxB.y = 5;
                              boxB.height = 10;
                            });

                            it('returns false', () => {
                              expect(isColliding(boxA, boxB)).to.be.false;
                            });
                          });

                          describe('when they do not overlap in the y direction', () => {
                            beforeEach(() => {
                              boxA.y = 0;
                              boxA.height = 10;
                              boxB.y = 20;
                              boxB.height = 10;
                            });

                            it('returns false', () => {
                              expect(isColliding(boxA, boxB)).to.be.false;
                            });
                          });
                        });
                      });
                    });
                    ```
                  </script>
                  <aside class="notes">
                  </aside>
                </section>
                <section data-markdown>
                  <script type="text/template">
                    ## Possible Method
                    ```
                    /**
                     * Given two rectangles, returns true if they're overlapping, false otherwise
                     * @param {{ x: Number, y: Number, width: Number, height: Number }} boxA
                     * @param {{ x: Number, y: Number, width: Number, height: Number }} boxB
                     * @returns {Boolean}
                     */
                    function isColliding(rectA, rectB) {
                      if (rectA.x > rectB.x + rectB.width || rectA.x + rectA.width < rectB.x) {
                        return false;
                      }
                      if (rectA.y > rectB.y + rectB.height || rectA.y + rectA.height < rectB.y) {
                        return false;
                      }

                      return true;
                    }
                    ```
                  </script>
                  <aside class="notes">
                  </aside>
                </section>
              </section>
              <section>
                <section data-markdown>
                  <script type="text/template">
                    ## Wrap Up
                    - TODO:
                    - What we learned.  What students should be able to do now.
                    - Some theory about making this a practical tool
                    - From here: other testing stuff, mocking if not yet covered.
                  </script>
                  <aside class="notes">
                  </aside>
                </section>
              </section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
